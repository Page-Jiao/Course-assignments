# 数据库系统及应用第七次作业

+ 焦培淇 &nbsp; &nbsp; PB17151767

## 1
事务的ACID属性包含：原子性，一致性，隔离性，持久性。

举例：

+ 违背原子性：A帐户向B帐户划账1000，则先将A减少1000，再将B增加1000，两个动作发生一个有效、一个无效的情况。
+ 违背一致性：A、B帐户的总金额在转账前和转帐后不一致。
+ 违背隔离性：在A、B之间转帐时，C同时向A转帐，即在A、B事务执行过程中，事务访问(修改)当前相关的数值。
+ 违背持久性：A向账户存入100，存款事务结束后，发生系统故障，A的存款记录丢失。

## 2

不可以，如果A,B均使用事务的话会构成事务嵌套执行，而破坏了外层事务的原子性。

## 3
### 1故障情形

首先正向扫描日志得到redo列表为{T1}，undo列表为{T2,T3}；

反向扫描日志，对于undo列表的事务操作，执行恢复如下：

E &rightarrow; 50, D &rightarrow; 40, C &rightarrow; 30

正向扫描日志，对于redo列表的事务操作，执行恢复如下：

A &rightarrow; 40, B &rightarrow; 60, A &rightarrow; 75

因此A,B,C,D,E,F,G在执行恢复后的值分别为:75,60,30,40,50,60,70。

### 2故障情形

首先正向扫描日志得到redo列表为{T1,T2}，undo列表为{T3}；

反向扫描日志，对于undo列表的事务操作，执行恢复如下：

E &rightarrow; 50

正向扫描日志，对于redo列表的事务操作，执行恢复如下：

A &rightarrow; 40, B &rightarrow; 60, A &rightarrow; 75, C &rightarrow; 50, D &rightarrow; 80, D &rightarrow; 65, C &rightarrow; 75

因此A,B,C,D,E,F,G在执行恢复后的值分别为:75,60,75,65,50,60,70。

### 3故障情形

首先对于检查点之前的日志不进行考虑。

正向扫描剩余日志得到redo列表为{}，undo列表为{T4}；

反向扫描日志，对于undo列表的事务操作，执行恢复如下：

G &rightarrow; 70, F &rightarrow; 60

因此A,B,C,D,E,F,G在执行恢复后的值分别为:75,60,75,65,90,60,70。